'use strict';

var _toConsumableArray = require('babel-runtime/helpers/to-consumable-array')['default'];

var _regeneratorRuntime = require('babel-runtime/regenerator')['default'];

var _getIterator = require('babel-runtime/core-js/get-iterator')['default'];

var _interopRequireDefault = require('babel-runtime/helpers/interop-require-default')['default'];

var _chai = require('chai');

var _chai2 = _interopRequireDefault(_chai);

var _chaiAsPromised = require('chai-as-promised');

var _chaiAsPromised2 = _interopRequireDefault(_chaiAsPromised);

var _wd = require('wd');

var _wd2 = _interopRequireDefault(_wd);

var _requestPromise = require('request-promise');

var _requestPromise2 = _interopRequireDefault(_requestPromise);

var _bluebird = require('bluebird');

var _bluebird2 = _interopRequireDefault(_bluebird);

var _lodash = require('lodash');

var _lodash2 = _interopRequireDefault(_lodash);

var _helpersSession = require('../helpers/session');

var _desired = require('../desired');

_chai2['default'].should();
_chai2['default'].use(_chaiAsPromised2['default']);

// TODO: Add missing client features to admc/wd

describe('touch actions -', function () {
  this.timeout(_helpersSession.MOCHA_TIMEOUT);

  var driver = undefined;
  var sessionId = undefined;
  before(function callee$1$0() {
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap((0, _helpersSession.initSession)(_desired.APIDEMO_CAPS));

        case 2:
          driver = context$2$0.sent;
          context$2$0.next = 5;
          return _regeneratorRuntime.awrap(driver.getSessionId());

        case 5:
          sessionId = context$2$0.sent;

        case 6:
        case 'end':
          return context$2$0.stop();
      }
    }, null, this);
  });
  after(function callee$1$0() {
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap((0, _helpersSession.deleteSession)());

        case 2:
        case 'end':
          return context$2$0.stop();
      }
    }, null, this);
  });

  function startListActivity() {
    return _regeneratorRuntime.async(function startListActivity$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.startActivity({
            appActivity: '.view.List5',
            appPackage: 'io.appium.android.apis'
          }));

        case 2:
        case 'end':
          return context$2$0.stop();
      }
    }, null, this);
  }

  function startFingerPaintActivity() {
    return _regeneratorRuntime.async(function startFingerPaintActivity$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.startActivity({
            appActivity: '.graphics.FingerPaint',
            appPackage: 'io.appium.android.apis'
          }));

        case 2:
        case 'end':
          return context$2$0.stop();
      }
    }, null, this);
  }

  function startSplitTouchActivity() {
    return _regeneratorRuntime.async(function startSplitTouchActivity$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.startActivity({
            appActivity: '.view.SplitTouchView',
            appPackage: 'io.appium.android.apis'
          }));

        case 2:
        case 'end':
          return context$2$0.stop();
      }
    }, null, this);
  }

  function startDragAndDropActivity() {
    return _regeneratorRuntime.async(function startDragAndDropActivity$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.startActivity({
            appActivity: '.view.DragAndDropDemo',
            appPackage: 'io.appium.android.apis'
          }));

        case 2:
        case 'end':
          return context$2$0.stop();
      }
    }, null, this);
  }

  function startTextSwitcherActivity() {
    return _regeneratorRuntime.async(function startTextSwitcherActivity$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.startActivity({
            appActivity: '.view.TextSwitcher1',
            appPackage: 'io.appium.android.apis'
          }));

        case 2:
        case 'end':
          return context$2$0.stop();
      }
    }, null, this);
  }

  function getScrollData() {
    var els, startEl, _ref, startX, startY, endEl, _ref2, endX, endY;

    return _regeneratorRuntime.async(function getScrollData$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.elementsByClassName('android.widget.TextView'));

        case 2:
          els = context$2$0.sent;
          startEl = els[els.length - 3];
          context$2$0.next = 6;
          return _regeneratorRuntime.awrap(startEl.getLocation());

        case 6:
          _ref = context$2$0.sent;
          startX = _ref.x;
          startY = _ref.y;
          endEl = _lodash2['default'].first(els);
          context$2$0.next = 12;
          return _regeneratorRuntime.awrap(endEl.getLocation());

        case 12:
          _ref2 = context$2$0.sent;
          endX = _ref2.x;
          endY = _ref2.y;
          return context$2$0.abrupt('return', { startX: startX, startY: startY, endX: endX, endY: endY, startEl: startEl, endEl: endEl });

        case 16:
        case 'end':
          return context$2$0.stop();
      }
    }, null, this);
  }

  function assertScroll() {
    return _regeneratorRuntime.async(function assertScroll$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          context$2$0.next = 2;
          return _regeneratorRuntime.awrap(driver.elementByXPath("//*[@text='Abbaye de Belloc']").should.eventually.be.rejectedWith(/NoSuchElement/));

        case 2:
        case 'end':
          return context$2$0.stop();
      }
    }, null, this);
  }

  var idCounter = 0;

  var performTouchAction = function performTouchAction() {
    var actionsRoot,
        _iteratorNormalCompletion,
        _didIteratorError,
        _iteratorError,
        _len,
        actionsArrays,
        _key,
        _iterator,
        _step,
        actions,
        args$2$0 = arguments;

    return _regeneratorRuntime.async(function performTouchAction$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          actionsRoot = [];
          _iteratorNormalCompletion = true;
          _didIteratorError = false;
          _iteratorError = undefined;
          context$2$0.prev = 4;

          for (_len = args$2$0.length, actionsArrays = Array(_len), _key = 0; _key < _len; _key++) {
            actionsArrays[_key] = args$2$0[_key];
          }

          for (_iterator = _getIterator(actionsArrays); !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
            actions = _step.value;

            actionsRoot.push({
              type: 'pointer',
              id: 'id_' + idCounter++,
              parameters: {
                pointerType: 'touch'
              },
              actions: actions
            });
          }

          context$2$0.next = 13;
          break;

        case 9:
          context$2$0.prev = 9;
          context$2$0.t0 = context$2$0['catch'](4);
          _didIteratorError = true;
          _iteratorError = context$2$0.t0;

        case 13:
          context$2$0.prev = 13;
          context$2$0.prev = 14;

          if (!_iteratorNormalCompletion && _iterator['return']) {
            _iterator['return']();
          }

        case 16:
          context$2$0.prev = 16;

          if (!_didIteratorError) {
            context$2$0.next = 19;
            break;
          }

          throw _iteratorError;

        case 19:
          return context$2$0.finish(16);

        case 20:
          return context$2$0.finish(13);

        case 21:
          context$2$0.next = 23;
          return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
            method: 'POST',
            uri: 'http://' + _helpersSession.HOST + ':' + _helpersSession.PORT + '/wd/hub/session/' + sessionId + '/actions',
            body: { actions: actionsRoot },
            json: true
          }));

        case 23:
        case 'end':
          return context$2$0.stop();
      }
    }, null, this, [[4, 9, 13, 21], [14,, 16, 20]]);
  };

  describe('fingerpaint', function callee$1$0() {
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          beforeEach(startFingerPaintActivity);

          it('should draw the letter L on fingerpaint', function callee$2$0() {
            var canvas, _ref3, x, y, _ref4, height, width, startX, startY, endX, endY, touchActions;

            return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
              while (1) switch (context$3$0.prev = context$3$0.next) {
                case 0:
                  context$3$0.next = 2;
                  return _regeneratorRuntime.awrap(driver.elementById("android:id/content"));

                case 2:
                  canvas = context$3$0.sent;
                  context$3$0.next = 5;
                  return _regeneratorRuntime.awrap(canvas.getLocation());

                case 5:
                  _ref3 = context$3$0.sent;
                  x = _ref3.x;
                  y = _ref3.y;
                  context$3$0.next = 10;
                  return _regeneratorRuntime.awrap(canvas.getSize());

                case 10:
                  _ref4 = context$3$0.sent;
                  height = _ref4.height;
                  width = _ref4.width;
                  startX = x + 10;
                  startY = y + 10;
                  endX = x + width - 10;
                  endY = y + Math.round(height / 2);
                  touchActions = [{ type: "pointerMove", duration: 1000, x: startX, y: startY }, { type: "pointerDown", button: 0 }, { type: "pointerMove", duration: 1000, x: startX, y: endY }, { type: "pause", duration: 1000 }, { type: "pointerMove", duration: 1000, x: endX, y: endY }, { type: "pointerCancel", button: 0 }];
                  context$3$0.next = 20;
                  return _regeneratorRuntime.awrap(performTouchAction(touchActions));

                case 20:
                case 'end':
                  return context$3$0.stop();
              }
            }, null, this);
          });

          it('should draw two parallel lines on fingerpaint', function callee$2$0() {
            var canvas, _ref5, x, y, _ref6, height, width, touchActions;

            return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
              while (1) switch (context$3$0.prev = context$3$0.next) {
                case 0:
                  context$3$0.next = 2;
                  return _regeneratorRuntime.awrap(driver.elementById("android:id/content"));

                case 2:
                  canvas = context$3$0.sent;
                  context$3$0.next = 5;
                  return _regeneratorRuntime.awrap(canvas.getLocation());

                case 5:
                  _ref5 = context$3$0.sent;
                  x = _ref5.x;
                  y = _ref5.y;
                  context$3$0.next = 10;
                  return _regeneratorRuntime.awrap(canvas.getSize());

                case 10:
                  _ref6 = context$3$0.sent;
                  height = _ref6.height;
                  width = _ref6.width;
                  touchActions = [10, width - 10].reduce(function (touchActions, xOffset) {
                    touchActions.push([{ type: "pointerMove", x: x + xOffset, y: y + 10 }, { type: "pointerDown", button: 0 }, { type: "pointerMove", duration: 2000, x: x + xOffset, y: y + Math.round(height / 2) }, { type: "pointerUp", button: 0 }]);
                    return touchActions;
                  }, []);
                  context$3$0.next = 16;
                  return _regeneratorRuntime.awrap(performTouchAction.apply(undefined, _toConsumableArray(touchActions)));

                case 16:
                case 'end':
                  return context$3$0.stop();
              }
            }, null, this);
          });

        case 3:
        case 'end':
          return context$2$0.stop();
      }
    }, null, this);
  });

  describe('scrolling/swiping', function callee$1$0() {
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          describe('single', function () {
            beforeEach(startListActivity);

            it('should scroll up menu', function callee$3$0() {
              var _ref7, startX, startY, endX, endY, actions;

              return _regeneratorRuntime.async(function callee$3$0$(context$4$0) {
                while (1) switch (context$4$0.prev = context$4$0.next) {
                  case 0:
                    context$4$0.next = 2;
                    return _regeneratorRuntime.awrap(getScrollData());

                  case 2:
                    _ref7 = context$4$0.sent;
                    startX = _ref7.startX;
                    startY = _ref7.startY;
                    endX = _ref7.endX;
                    endY = _ref7.endY;
                    actions = [{ type: "pointerMove", duration: 0, x: startX + 5, y: startY + 5 }, { type: "pointerDown", button: 0 }, { type: "pointerMove", duration: 200, x: endX + 5, y: endY + 5 }, { type: "pointerUp", button: 0 }];
                    context$4$0.next = 10;
                    return _regeneratorRuntime.awrap(performTouchAction(actions));

                  case 10:
                    context$4$0.next = 12;
                    return _regeneratorRuntime.awrap(assertScroll());

                  case 12:
                  case 'end':
                    return context$4$0.stop();
                }
              }, null, this);
            });

            it('should swipe up menu', function callee$3$0() {
              var _ref8, startX, startY, endX, endY, actions;

              return _regeneratorRuntime.async(function callee$3$0$(context$4$0) {
                while (1) switch (context$4$0.prev = context$4$0.next) {
                  case 0:
                    context$4$0.next = 2;
                    return _regeneratorRuntime.awrap(getScrollData());

                  case 2:
                    _ref8 = context$4$0.sent;
                    startX = _ref8.startX;
                    startY = _ref8.startY;
                    endX = _ref8.endX;
                    endY = _ref8.endY;
                    actions = [{ type: "pointerMove", duration: 0, x: startX + 5, y: startY + 5 }, { type: "pointerDown", button: 0 }, { type: "pointerMove", duration: 100, x: endX + 5, y: endY + 5 }, { type: "pointerUp", button: 0 }];
                    context$4$0.next = 10;
                    return _regeneratorRuntime.awrap(performTouchAction(actions));

                  case 10:
                    context$4$0.next = 12;
                    return _regeneratorRuntime.awrap(assertScroll());

                  case 12:
                  case 'end':
                    return context$4$0.stop();
                }
              }, null, this);
            });
          });

          describe('multiple', function () {
            beforeEach(startSplitTouchActivity);
            it('should do multiple scrolls on multiple views', function callee$3$0() {
              var els, actions;
              return _regeneratorRuntime.async(function callee$3$0$(context$4$0) {
                while (1) switch (context$4$0.prev = context$4$0.next) {
                  case 0:
                    context$4$0.next = 2;
                    return _regeneratorRuntime.awrap(driver.elementsByClassName('android.widget.ListView'));

                  case 2:
                    els = context$4$0.sent;
                    context$4$0.next = 5;
                    return _regeneratorRuntime.awrap(_bluebird2['default'].map(els, function callee$4$0(el) {
                      var _ref9, height, yMove, action;

                      return _regeneratorRuntime.async(function callee$4$0$(context$5$0) {
                        while (1) switch (context$5$0.prev = context$5$0.next) {
                          case 0:
                            context$5$0.next = 2;
                            return _regeneratorRuntime.awrap(el.getSize());

                          case 2:
                            _ref9 = context$5$0.sent;
                            height = _ref9.height;
                            yMove = Math.round(height / 2) - 10;
                            action = [{ type: "pointerMove", origin: { "element-6066-11e4-a52e-4f735466cecf": el.value } }, { type: "pointerDown", button: 0 }, { type: "pointerMove", origin: { "element-6066-11e4-a52e-4f735466cecf": el.value }, x: 10, y: -yMove, duration: 3000 }, { type: "pointerMove", origin: "pointer", x: 10, y: -yMove, duration: 3000 }, { type: "pointerUp", button: 0 }];
                            return context$5$0.abrupt('return', action);

                          case 7:
                          case 'end':
                            return context$5$0.stop();
                        }
                      }, null, this);
                    }));

                  case 5:
                    actions = context$4$0.sent;
                    context$4$0.next = 8;
                    return _regeneratorRuntime.awrap(performTouchAction.apply(undefined, _toConsumableArray(actions)));

                  case 8:
                  case 'end':
                    return context$4$0.stop();
                }
              }, null, this);
            });
          });

          it('should swipe on drag and drop', function callee$2$0() {
            var el, _ref10, x, y, touchActions;

            return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
              while (1) switch (context$3$0.prev = context$3$0.next) {
                case 0:
                  context$3$0.next = 2;
                  return _regeneratorRuntime.awrap(startDragAndDropActivity());

                case 2:
                  context$3$0.next = 4;
                  return _regeneratorRuntime.awrap(driver.elementById("io.appium.android.apis:id/drag_dot_1"));

                case 4:
                  el = context$3$0.sent;
                  context$3$0.next = 7;
                  return _regeneratorRuntime.awrap(el.getLocation());

                case 7:
                  _ref10 = context$3$0.sent;
                  x = _ref10.x;
                  y = _ref10.y;
                  touchActions = [{ type: "pointerMove", duration: 0, x: x + 30, y: y + 30 }, { type: "pointerDown", button: 0 }, { type: "pointerMove", duration: 100, x: x + 10, y: y + 10 }, { type: "pointerUp", button: 0 }];
                  context$3$0.next = 13;
                  return _regeneratorRuntime.awrap(performTouchAction(touchActions));

                case 13:
                case 'end':
                  return context$3$0.stop();
              }
            }, null, this);
          });

        case 3:
        case 'end':
          return context$2$0.stop();
      }
    }, null, this);
  });

  describe('touches', function callee$1$0() {
    var nextEl;
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          nextEl = undefined;

          beforeEach(function callee$2$0() {
            return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
              while (1) switch (context$3$0.prev = context$3$0.next) {
                case 0:
                  context$3$0.next = 2;
                  return _regeneratorRuntime.awrap(startTextSwitcherActivity());

                case 2:
                  context$3$0.next = 4;
                  return _regeneratorRuntime.awrap(driver.elementByXPath("//*[@text='0']").should.eventually.exist);

                case 4:
                  context$3$0.next = 6;
                  return _regeneratorRuntime.awrap(driver.elementByXPath("//*[@text='1']").should.eventually.be.rejectedWith(/NoSuchElement/));

                case 6:
                  context$3$0.next = 8;
                  return _regeneratorRuntime.awrap(driver.elementByAccessibilityId('Next'));

                case 8:
                  nextEl = context$3$0.sent;

                case 9:
                case 'end':
                  return context$3$0.stop();
              }
            }, null, this);
          });
          it('should touch down and up', function callee$2$0() {
            var _ref11, x, y, touchActions;

            return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
              while (1) switch (context$3$0.prev = context$3$0.next) {
                case 0:
                  context$3$0.next = 2;
                  return _regeneratorRuntime.awrap(nextEl.getLocation());

                case 2:
                  _ref11 = context$3$0.sent;
                  x = _ref11.x;
                  y = _ref11.y;
                  touchActions = [{ type: "pointerMove", duration: 100, x: x + 10, y: y + 10 }, { type: "pointerDown", button: 0 }, { type: "pause", duration: 3000 }, { type: "pointerUp", button: 0 }];
                  context$3$0.next = 8;
                  return _regeneratorRuntime.awrap(performTouchAction(touchActions));

                case 8:
                  context$3$0.next = 10;
                  return _regeneratorRuntime.awrap(driver.elementByXPath("//*[@text='1']").should.eventually.exist);

                case 10:
                case 'end':
                  return context$3$0.stop();
              }
            }, null, this);
          });

          it('should touch down and up on an element by id', function callee$2$0() {
            var touchActions;
            return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
              while (1) switch (context$3$0.prev = context$3$0.next) {
                case 0:
                  touchActions = [{ type: "pointerMove", duration: 0, origin: { "element-6066-11e4-a52e-4f735466cecf": nextEl.value } }, { type: "pointerDown", button: 0 }, { type: "pause", duration: 100 }, { type: "pointerUp", button: 0 }];
                  context$3$0.next = 3;
                  return _regeneratorRuntime.awrap(performTouchAction(touchActions));

                case 3:
                  context$3$0.next = 5;
                  return _regeneratorRuntime.awrap(driver.elementByXPath("//*[@text='1']").should.eventually.exist);

                case 5:
                case 'end':
                  return context$3$0.stop();
              }
            }, null, this);
          });

        case 4:
        case 'end':
          return context$2$0.stop();
      }
    }, null, this);
  });

  describe('mjsonwp touch actions', function () {
    describe('touch', function () {
      var nextEl = undefined;

      beforeEach(function callee$3$0() {
        return _regeneratorRuntime.async(function callee$3$0$(context$4$0) {
          while (1) switch (context$4$0.prev = context$4$0.next) {
            case 0:
              context$4$0.next = 2;
              return _regeneratorRuntime.awrap(startTextSwitcherActivity());

            case 2:
              context$4$0.next = 4;
              return _regeneratorRuntime.awrap(driver.elementByXPath("//*[@text='0']").should.eventually.exist);

            case 4:
              context$4$0.next = 6;
              return _regeneratorRuntime.awrap(driver.elementByXPath("//*[@text='1']").should.eventually.be.rejectedWith(/NoSuchElement/));

            case 6:
              context$4$0.next = 8;
              return _regeneratorRuntime.awrap(driver.elementByAccessibilityId('Next'));

            case 8:
              nextEl = context$4$0.sent;

            case 9:
            case 'end':
              return context$4$0.stop();
          }
        }, null, this);
      });

      it('should do touch/click event', function callee$3$0() {
        var _nextEl, elementId;

        return _regeneratorRuntime.async(function callee$3$0$(context$4$0) {
          while (1) switch (context$4$0.prev = context$4$0.next) {
            case 0:
              _nextEl = nextEl;
              elementId = _nextEl.value;
              context$4$0.next = 4;
              return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                method: 'POST',
                uri: 'http://' + _helpersSession.HOST + ':' + _helpersSession.PORT + '/wd/hub/session/' + sessionId + '/touch/click',
                body: {
                  element: elementId
                },
                json: true
              }));

            case 4:
              context$4$0.next = 6;
              return _regeneratorRuntime.awrap(driver.elementByXPath("//*[@text='1']").should.eventually.exist);

            case 6:
            case 'end':
              return context$4$0.stop();
          }
        }, null, this);
      });

      it('should do touch/longclick event', function callee$3$0() {
        var _nextEl2, elementId;

        return _regeneratorRuntime.async(function callee$3$0$(context$4$0) {
          while (1) switch (context$4$0.prev = context$4$0.next) {
            case 0:
              _nextEl2 = nextEl;
              elementId = _nextEl2.value;
              context$4$0.next = 4;
              return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                method: 'POST',
                uri: 'http://' + _helpersSession.HOST + ':' + _helpersSession.PORT + '/wd/hub/session/' + sessionId + '/touch/longclick',
                body: {
                  element: elementId
                },
                json: true
              }));

            case 4:
              context$4$0.next = 6;
              return _regeneratorRuntime.awrap(driver.elementByXPath("//*[@text='1']").should.eventually.exist);

            case 6:
            case 'end':
              return context$4$0.stop();
          }
        }, null, this);
      });

      it('should do touch/doubleclick event', function callee$3$0() {
        var _nextEl3, elementId;

        return _regeneratorRuntime.async(function callee$3$0$(context$4$0) {
          while (1) switch (context$4$0.prev = context$4$0.next) {
            case 0:
              context$4$0.next = 2;
              return _regeneratorRuntime.awrap(driver.elementByXPath("//*[@text='2']").should.eventually.be.rejectedWith(/NoSuchElement/));

            case 2:
              _nextEl3 = nextEl;
              elementId = _nextEl3.value;
              context$4$0.next = 6;
              return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                method: 'POST',
                uri: 'http://' + _helpersSession.HOST + ':' + _helpersSession.PORT + '/wd/hub/session/' + sessionId + '/touch/doubleclick',
                body: {
                  element: elementId
                },
                json: true
              }));

            case 6:
              context$4$0.next = 8;
              return _regeneratorRuntime.awrap(driver.elementByXPath("//*[@text='1']").should.eventually.exist);

            case 8:
              context$4$0.next = 10;
              return _regeneratorRuntime.awrap(driver.elementByXPath("//*[@text='2']").should.eventually.exist);

            case 10:
            case 'end':
              return context$4$0.stop();
          }
        }, null, this);
      });

      it('should touch down at a location and then touch up', function callee$3$0() {
        var _ref12, x, y;

        return _regeneratorRuntime.async(function callee$3$0$(context$4$0) {
          while (1) switch (context$4$0.prev = context$4$0.next) {
            case 0:
              context$4$0.next = 2;
              return _regeneratorRuntime.awrap(nextEl.getLocation());

            case 2:
              _ref12 = context$4$0.sent;
              x = _ref12.x;
              y = _ref12.y;
              context$4$0.next = 7;
              return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                method: 'POST',
                uri: 'http://' + _helpersSession.HOST + ':' + _helpersSession.PORT + '/wd/hub/session/' + sessionId + '/touch/down',
                body: {
                  x: x + 1,
                  y: y + 1
                },
                json: true
              }));

            case 7:
              context$4$0.next = 9;
              return _regeneratorRuntime.awrap(_bluebird2['default'].delay(1000));

            case 9:
              context$4$0.next = 11;
              return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                method: 'POST',
                uri: 'http://' + _helpersSession.HOST + ':' + _helpersSession.PORT + '/wd/hub/session/' + sessionId + '/touch/up',
                body: {
                  x: x + 1,
                  y: y + 1
                },
                json: true
              }));

            case 11:
              context$4$0.next = 13;
              return _regeneratorRuntime.awrap(driver.elementByXPath("//*[@text='1']").should.eventually.exist);

            case 13:
            case 'end':
              return context$4$0.stop();
          }
        }, null, this);
      });
    });

    describe('move', function () {
      beforeEach(startListActivity);

      it('should touch down, move, touch up and cause a scroll event', function callee$3$0() {
        var _ref13, startX, startY, endX, endY;

        return _regeneratorRuntime.async(function callee$3$0$(context$4$0) {
          while (1) switch (context$4$0.prev = context$4$0.next) {
            case 0:
              context$4$0.next = 2;
              return _regeneratorRuntime.awrap(getScrollData());

            case 2:
              _ref13 = context$4$0.sent;
              startX = _ref13.startX;
              startY = _ref13.startY;
              endX = _ref13.endX;
              endY = _ref13.endY;
              context$4$0.next = 9;
              return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                method: 'POST',
                uri: 'http://' + _helpersSession.HOST + ':' + _helpersSession.PORT + '/wd/hub/session/' + sessionId + '/touch/down',
                body: {
                  x: startX + 1,
                  y: startY + 1
                },
                json: true
              }));

            case 9:
              context$4$0.next = 11;
              return _regeneratorRuntime.awrap(_bluebird2['default'].delay(1000));

            case 11:
              context$4$0.next = 13;
              return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                method: 'POST',
                uri: 'http://' + _helpersSession.HOST + ':' + _helpersSession.PORT + '/wd/hub/session/' + sessionId + '/touch/move',
                body: {
                  x: endX + 1,
                  y: endY + 1
                },
                json: true
              }));

            case 13:
              context$4$0.next = 15;
              return _regeneratorRuntime.awrap(_bluebird2['default'].delay(1000));

            case 15:
              context$4$0.next = 17;
              return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                method: 'POST',
                uri: 'http://' + _helpersSession.HOST + ':' + _helpersSession.PORT + '/wd/hub/session/' + sessionId + '/touch/up',
                body: {
                  x: endX + 1,
                  y: endY + 1
                },
                json: true
              }));

            case 17:
              context$4$0.next = 19;
              return _regeneratorRuntime.awrap(assertScroll());

            case 19:
            case 'end':
              return context$4$0.stop();
          }
        }, null, this);
      });

      it('should scroll on an element', function callee$3$0() {
        return _regeneratorRuntime.async(function callee$3$0$(context$4$0) {
          while (1) switch (context$4$0.prev = context$4$0.next) {
            case 0:
              context$4$0.next = 2;
              return _regeneratorRuntime.awrap((0, _requestPromise2['default'])({
                method: 'POST',
                uri: 'http://' + _helpersSession.HOST + ':' + _helpersSession.PORT + '/wd/hub/session/' + sessionId + '/touch/scroll',
                body: {
                  //element: el.value,
                  x: 0,
                  y: -300
                },
                json: true
              }));

            case 2:
              context$4$0.next = 4;
              return _regeneratorRuntime.awrap(_bluebird2['default'].delay(1000));

            case 4:
            case 'end':
              return context$4$0.stop();
          }
        }, null, this);
      });
    });
  });

  describe('mjsonwp touch actions', function () {
    describe('multi touch actions', function () {
      var nextEl = undefined;

      beforeEach(function callee$3$0() {
        return _regeneratorRuntime.async(function callee$3$0$(context$4$0) {
          while (1) switch (context$4$0.prev = context$4$0.next) {
            case 0:
              context$4$0.next = 2;
              return _regeneratorRuntime.awrap(startTextSwitcherActivity());

            case 2:
              context$4$0.next = 4;
              return _regeneratorRuntime.awrap(driver.elementByXPath("//*[@text='0']").should.eventually.exist);

            case 4:
              context$4$0.next = 6;
              return _regeneratorRuntime.awrap(driver.elementByXPath("//*[@text='1']").should.eventually.be.rejectedWith(/NoSuchElement/));

            case 6:
              context$4$0.next = 8;
              return _regeneratorRuntime.awrap(driver.elementByAccessibilityId('Next'));

            case 8:
              nextEl = context$4$0.sent;

            case 9:
            case 'end':
              return context$4$0.stop();
          }
        }, null, this);
      });

      var _arr = ['tap', 'press', 'longPress'];

      var _loop = function () {
        var method = _arr[_i];
        it('should perform single ' + method + ' actions on an element', function callee$4$0() {
          var action, multiAction;
          return _regeneratorRuntime.async(function callee$4$0$(context$5$0) {
            while (1) switch (context$5$0.prev = context$5$0.next) {
              case 0:
                action = new _wd2['default'].TouchAction();

                action[method]({ el: nextEl });

                multiAction = new _wd2['default'].MultiAction(driver);

                multiAction.add(action);
                context$5$0.next = 6;
                return _regeneratorRuntime.awrap(multiAction.perform());

              case 6:
                context$5$0.next = 8;
                return _regeneratorRuntime.awrap(driver.elementByXPath("//*[@text='1']").should.eventually.exist);

              case 8:
              case 'end':
                return context$5$0.stop();
            }
          }, null, this);
        });

        it('should perform single ' + method + ' actions', function callee$4$0() {
          var _ref14, x, y, action, multiAction;

          return _regeneratorRuntime.async(function callee$4$0$(context$5$0) {
            while (1) switch (context$5$0.prev = context$5$0.next) {
              case 0:
                context$5$0.next = 2;
                return _regeneratorRuntime.awrap(nextEl.getLocation());

              case 2:
                _ref14 = context$5$0.sent;
                x = _ref14.x;
                y = _ref14.y;
                action = new _wd2['default'].TouchAction();

                action[method]({ x: x + 10, y: y + 10 });

                multiAction = new _wd2['default'].MultiAction(driver);

                multiAction.add(action);
                context$5$0.next = 11;
                return _regeneratorRuntime.awrap(multiAction.perform());

              case 11:
                context$5$0.next = 13;
                return _regeneratorRuntime.awrap(driver.elementByXPath("//*[@text='1']").should.eventually.exist);

              case 13:
              case 'end':
                return context$5$0.stop();
            }
          }, null, this);
        });
      };

      for (var _i = 0; _i < _arr.length; _i++) {
        _loop();
      }
    });

    describe('touch actions', function () {
      describe('tap/press/longPress', function () {
        var nextEl = undefined;

        beforeEach(function callee$4$0() {
          return _regeneratorRuntime.async(function callee$4$0$(context$5$0) {
            while (1) switch (context$5$0.prev = context$5$0.next) {
              case 0:
                context$5$0.next = 2;
                return _regeneratorRuntime.awrap(startTextSwitcherActivity());

              case 2:
                context$5$0.next = 4;
                return _regeneratorRuntime.awrap(driver.elementByXPath("//*[@text='0']").should.eventually.exist);

              case 4:
                context$5$0.next = 6;
                return _regeneratorRuntime.awrap(driver.elementByXPath("//*[@text='1']").should.eventually.be.rejectedWith(/NoSuchElement/));

              case 6:
                context$5$0.next = 8;
                return _regeneratorRuntime.awrap(driver.elementByAccessibilityId('Next'));

              case 8:
                nextEl = context$5$0.sent;

              case 9:
              case 'end':
                return context$5$0.stop();
            }
          }, null, this);
        });

        var _arr2 = ['tap', 'press', 'longPress'];

        var _loop2 = function () {
          var method = _arr2[_i2];
          it('should perform single ' + method + ' actions', function callee$5$0() {
            var _ref15, x, y, action;

            return _regeneratorRuntime.async(function callee$5$0$(context$6$0) {
              while (1) switch (context$6$0.prev = context$6$0.next) {
                case 0:
                  context$6$0.next = 2;
                  return _regeneratorRuntime.awrap(nextEl.getLocation());

                case 2:
                  _ref15 = context$6$0.sent;
                  x = _ref15.x;
                  y = _ref15.y;
                  action = new _wd2['default'].TouchAction(driver);

                  action[method]({ x: x + 10, y: y + 10 });
                  context$6$0.next = 9;
                  return _regeneratorRuntime.awrap(action.perform());

                case 9:
                  context$6$0.next = 11;
                  return _regeneratorRuntime.awrap(driver.elementByXPath("//*[@text='1']").should.eventually.exist);

                case 11:
                case 'end':
                  return context$6$0.stop();
              }
            }, null, this);
          });
          it('should perform single ' + method + ' actions on an element', function callee$5$0() {
            var action;
            return _regeneratorRuntime.async(function callee$5$0$(context$6$0) {
              while (1) switch (context$6$0.prev = context$6$0.next) {
                case 0:
                  action = new _wd2['default'].TouchAction(driver);

                  action[method]({ el: nextEl });
                  context$6$0.next = 4;
                  return _regeneratorRuntime.awrap(action.perform());

                case 4:
                  context$6$0.next = 6;
                  return _regeneratorRuntime.awrap(driver.elementByXPath("//*[@text='1']").should.eventually.exist);

                case 6:
                case 'end':
                  return context$6$0.stop();
              }
            }, null, this);
          });
        };

        for (var _i2 = 0; _i2 < _arr2.length; _i2++) {
          _loop2();
        }
      });
      it('should perform a scroll event', function callee$3$0() {
        var _ref16, startEl, endEl, action;

        return _regeneratorRuntime.async(function callee$3$0$(context$4$0) {
          while (1) switch (context$4$0.prev = context$4$0.next) {
            case 0:
              context$4$0.next = 2;
              return _regeneratorRuntime.awrap(startListActivity());

            case 2:
              context$4$0.next = 4;
              return _regeneratorRuntime.awrap(getScrollData());

            case 4:
              _ref16 = context$4$0.sent;
              startEl = _ref16.startEl;
              endEl = _ref16.endEl;
              action = new _wd2['default'].TouchAction(driver);

              action.press({ el: startEl });
              action.moveTo({ el: endEl });
              action.release();
              context$4$0.next = 13;
              return _regeneratorRuntime.awrap(action.perform());

            case 13:
              context$4$0.next = 15;
              return _regeneratorRuntime.awrap(assertScroll());

            case 15:
            case 'end':
              return context$4$0.stop();
          }
        }, null, this);
      });
      it('should do multiple scrolls on multiple views', function callee$3$0() {
        var els, actions, multiAction;
        return _regeneratorRuntime.async(function callee$3$0$(context$4$0) {
          while (1) switch (context$4$0.prev = context$4$0.next) {
            case 0:
              context$4$0.next = 2;
              return _regeneratorRuntime.awrap(startSplitTouchActivity());

            case 2:
              context$4$0.next = 4;
              return _regeneratorRuntime.awrap(driver.elementsByClassName('android.widget.ListView'));

            case 4:
              els = context$4$0.sent;
              context$4$0.next = 7;
              return _regeneratorRuntime.awrap(_bluebird2['default'].map(els, function callee$4$0(el) {
                var _ref17, height, increment, action, i;

                return _regeneratorRuntime.async(function callee$4$0$(context$5$0) {
                  while (1) switch (context$5$0.prev = context$5$0.next) {
                    case 0:
                      context$5$0.next = 2;
                      return _regeneratorRuntime.awrap(el.getSize());

                    case 2:
                      _ref17 = context$5$0.sent;
                      height = _ref17.height;
                      increment = Math.round((height - 10) / 8);
                      action = new _wd2['default'].TouchAction().press({ element: el });

                      for (i = 0; i < 8; i++) {
                        action.moveTo({ element: el, x: 10, y: -i * increment });
                      }
                      action.release();
                      return context$5$0.abrupt('return', action);

                    case 9:
                    case 'end':
                      return context$5$0.stop();
                  }
                }, null, this);
              }));

            case 7:
              actions = context$4$0.sent;
              multiAction = new _wd2['default'].MultiAction();

              multiAction.add.apply(multiAction, _toConsumableArray(actions));

              context$4$0.next = 12;
              return _regeneratorRuntime.awrap(driver.performMultiAction(multiAction));

            case 12:
              context$4$0.next = 14;
              return _regeneratorRuntime.awrap(_bluebird2['default'].delay(5000));

            case 14:
            case 'end':
              return context$4$0.stop();
          }
        }, null, this);
      });
    });
  });
});

// the last element is the title of the view, and often the
// second-to-last is actually off the screen
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRlc3QvZnVuY3Rpb25hbC9jb21tYW5kcy90b3VjaC1lMmUtc3BlY3MuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztvQkFBaUIsTUFBTTs7Ozs4QkFDSSxrQkFBa0I7Ozs7a0JBQzlCLElBQUk7Ozs7OEJBQ0MsaUJBQWlCOzs7O3dCQUN2QixVQUFVOzs7O3NCQUNWLFFBQVE7Ozs7OEJBRVEsb0JBQW9COzt1QkFDckIsWUFBWTs7QUFHekMsa0JBQUssTUFBTSxFQUFFLENBQUM7QUFDZCxrQkFBSyxHQUFHLDZCQUFnQixDQUFDOzs7O0FBSXpCLFFBQVEsQ0FBQyxpQkFBaUIsRUFBRSxZQUFZO0FBQ3RDLE1BQUksQ0FBQyxPQUFPLCtCQUFlLENBQUM7O0FBRTVCLE1BQUksTUFBTSxZQUFBLENBQUM7QUFDWCxNQUFJLFNBQVMsWUFBQSxDQUFDO0FBQ2QsUUFBTSxDQUFDOzs7OzsyQ0FDVSx1REFBeUI7OztBQUF4QyxnQkFBTTs7MkNBQ1ksTUFBTSxDQUFDLFlBQVksRUFBRTs7O0FBQXZDLG1CQUFTOzs7Ozs7O0dBQ1YsQ0FBQyxDQUFDO0FBQ0gsT0FBSyxDQUFDOzs7OzsyQ0FDRSxvQ0FBZTs7Ozs7OztHQUN0QixDQUFDLENBQUM7O0FBRUgsV0FBZSxpQkFBaUI7Ozs7OzJDQUN4QixNQUFNLENBQUMsYUFBYSxDQUFDO0FBQ3pCLHVCQUFXLEVBQUUsYUFBYTtBQUMxQixzQkFBVSxFQUFFLHdCQUF3QjtXQUNyQyxDQUFDOzs7Ozs7O0dBQ0g7O0FBRUQsV0FBZSx3QkFBd0I7Ozs7OzJDQUMvQixNQUFNLENBQUMsYUFBYSxDQUFDO0FBQ3pCLHVCQUFXLEVBQUUsdUJBQXVCO0FBQ3BDLHNCQUFVLEVBQUUsd0JBQXdCO1dBQ3JDLENBQUM7Ozs7Ozs7R0FDSDs7QUFFRCxXQUFlLHVCQUF1Qjs7Ozs7MkNBQzlCLE1BQU0sQ0FBQyxhQUFhLENBQUM7QUFDekIsdUJBQVcsRUFBRSxzQkFBc0I7QUFDbkMsc0JBQVUsRUFBRSx3QkFBd0I7V0FDckMsQ0FB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RyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUU7QUFDMUIsOEJBQU0sQ0FBQyxNQUFNLENBQUMsRUFBQyxPQUFPLEVBQUUsRUFBRSxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxHQUFHLFNBQVMsRUFBQyxDQUFDLENBQUM7dUJBQ3hEO0FBQ0QsNEJBQU0sQ0FBQyxPQUFPLEVBQUUsQ0FBQzswREFDVixNQUFNOzs7Ozs7O2VBQ2QsQ0FBQzs7O0FBWEkscUJBQU87QUFhUCx5QkFBVyxHQUFHLElBQUksZ0JBQUcsV0FBVyxFQUFFOztBQUN4Qyx5QkFBVyxDQUFDLEdBQUcsTUFBQSxDQUFmLFdBQVcscUJBQVEsT0FBTyxFQUFDLENBQUM7OzsrQ0FFdEIsTUFBTSxDQUFDLGtCQUFrQixDQUFDLFdBQVcsQ0FBQzs7OzsrQ0FDdEMsc0JBQUUsS0FBSyxDQUFDLElBQUksQ0FBQzs7Ozs7OztPQUNwQixDQUFDLENBQUM7S0FDSixDQUFDLENBQUM7R0FDSixDQUFDLENBQUM7Q0FDSixDQUFDLENBQUMiLCJmaWxlIjoidGVzdC9mdW5jdGlvbmFsL2NvbW1hbmRzL3RvdWNoLWUyZS1zcGVjcy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBjaGFpIGZyb20gJ2NoYWknO1xuaW1wb3J0IGNoYWlBc1Byb21pc2VkIGZyb20gJ2NoYWktYXMtcHJvbWlzZWQnO1xuaW1wb3J0IHdkIGZyb20gJ3dkJztcbmltcG9ydCByZXF1ZXN0IGZyb20gJ3JlcXVlc3QtcHJvbWlzZSc7XG5pbXBvcnQgQiBmcm9tICdibHVlYmlyZCc7XG5pbXBvcnQgXyBmcm9tICdsb2Rhc2gnO1xuaW1wb3J0IHsgaW5pdFNlc3Npb24sIGRlbGV0ZVNlc3Npb24sIEhPU1QsIFBPUlQsXG4gICAgICAgICBNT0NIQV9USU1FT1VUIH0gZnJvbSAnLi4vaGVscGVycy9zZXNzaW9uJztcbmltcG9ydCB7IEFQSURFTU9fQ0FQUyB9IGZyb20gJy4uL2Rlc2lyZWQnO1xuXG5cbmNoYWkuc2hvdWxkKCk7XG5jaGFpLnVzZShjaGFpQXNQcm9taXNlZCk7XG5cbi8vIFRPRE86IEFkZCBtaXNzaW5nIGNsaWVudCBmZWF0dXJlcyB0byBhZG1jL3dkXG5cbmRlc2NyaWJlKCd0b3VjaCBhY3Rpb25zIC0nLCBmdW5jdGlvbiAoKSB7XG4gIHRoaXMudGltZW91dChNT0NIQV9USU1FT1VUKTtcblxuICBsZXQgZHJpdmVyO1xuICBsZXQgc2Vzc2lvbklkO1xuICBiZWZvcmUoYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgIGRyaXZlciA9IGF3YWl0IGluaXRTZXNzaW9uKEFQSURFTU9fQ0FQUyk7XG4gICAgc2Vzc2lvbklkID0gYXdhaXQgZHJpdmVyLmdldFNlc3Npb25JZCgpO1xuICB9KTtcbiAgYWZ0ZXIoYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgIGF3YWl0IGRlbGV0ZVNlc3Npb24oKTtcbiAgfSk7XG5cbiAgYXN5bmMgZnVuY3Rpb24gc3RhcnRMaXN0QWN0aXZpdHkgKCkge1xuICAgIGF3YWl0IGRyaXZlci5zdGFydEFjdGl2aXR5KHtcbiAgICAgIGFwcEFjdGl2aXR5OiAnLnZpZXcuTGlzdDUnLFxuICAgICAgYXBwUGFja2FnZTogJ2lvLmFwcGl1bS5hbmRyb2lkLmFwaXMnLFxuICAgIH0pO1xuICB9XG5cbiAgYXN5bmMgZnVuY3Rpb24gc3RhcnRGaW5nZXJQYWludEFjdGl2aXR5ICgpIHtcbiAgICBhd2FpdCBkcml2ZXIuc3RhcnRBY3Rpdml0eSh7XG4gICAgICBhcHBBY3Rpdml0eTogJy5ncmFwaGljcy5GaW5nZXJQYWludCcsXG4gICAgICBhcHBQYWNrYWdlOiAnaW8uYXBwaXVtLmFuZHJvaWQuYXBpcycsXG4gICAgfSk7XG4gIH1cblxuICBhc3luYyBmdW5jdGlvbiBzdGFydFNwbGl0VG91Y2hBY3Rpdml0eSAoKSB7XG4gICAgYXdhaXQgZHJpdmVyLnN0YXJ0QWN0aXZpdHkoe1xuICAgICAgYXBwQWN0aXZpdHk6ICcudmlldy5TcGxpdFRvdWNoVmlldycsXG4gICAgICBhcHBQYWNrYWdlOiAnaW8uYXBwaXVtLmFuZHJvaWQuYXBpcycsXG4gICAgfSk7XG4gIH1cblxuICBhc3luYyBmdW5jdGlvbiBzdGFydERyYWdBbmREcm9wQWN0aXZpdHkgKCkge1xuICAgIGF3YWl0IGRyaXZlci5zdGFydEFjdGl2aXR5KHtcbiAgICAgIGFwcEFjdGl2aXR5OiAnLnZpZXcuRHJhZ0FuZERyb3BEZW1vJyxcbiAgICAgIGFwcFBhY2thZ2U6ICdpby5hcHBpdW0uYW5kcm9pZC5hcGlzJyxcbiAgICB9KTtcbiAgfVxuXG4gIGFzeW5jIGZ1bmN0aW9uIHN0YXJ0VGV4dFN3aXRjaGVyQWN0aXZpdHkgKCkge1xuICAgIGF3YWl0IGRyaXZlci5zdGFydEFjdGl2aXR5KHtcbiAgICAgIGFwcEFjdGl2aXR5OiAnLnZpZXcuVGV4dFN3aXRjaGVyMScsXG4gICAgICBhcHBQYWNrYWdlOiAnaW8uYXBwaXVtLmFuZHJvaWQuYXBpcycsXG4gICAgfSk7XG4gIH1cblxuICBhc3luYyBmdW5jdGlvbiBnZXRTY3JvbGxEYXRhICgpIHtcbiAgICBjb25zdCBlbHMgPSBhd2FpdCBkcml2ZXIuZWxlbWVudHNCeUNsYXNzTmFtZSgnYW5kcm9pZC53aWRnZXQuVGV4dFZpZXcnKTtcblxuICAgIC8vIHRoZSBsYXN0IGVsZW1lbnQgaXMgdGhlIHRpdGxlIG9mIHRoZSB2aWV3LCBhbmQgb2Z0ZW4gdGhlXG4gICAgLy8gc2Vjb25kLXRvLWxhc3QgaXMgYWN0dWFsbHkgb2ZmIHRoZSBzY3JlZW5cbiAgICBjb25zdCBzdGFydEVsID0gZWxzW2Vscy5sZW5ndGggLSAzXTtcbiAgICBjb25zdCB7eDpzdGFydFgsIHk6c3RhcnRZfSA9IGF3YWl0IHN0YXJ0RWwuZ2V0TG9jYXRpb24oKTtcblxuICAgIGNvbnN0IGVuZEVsID0gXy5maXJzdChlbHMpO1xuICAgIGNvbnN0IHt4OmVuZFgsIHk6ZW5kWX0gPSBhd2FpdCBlbmRFbC5nZXRMb2NhdGlvbigpO1xuXG4gICAgcmV0dXJuIHtzdGFydFgsIHN0YXJ0WSwgZW5kWCwgZW5kWSwgc3RhcnRFbCwgZW5kRWx9O1xuICB9XG5cbiAgYXN5bmMgZnVuY3Rpb24gYXNzZXJ0U2Nyb2xsICgpIHtcbiAgICBhd2FpdCBkcml2ZXIuZWxlbWVudEJ5WFBhdGgoXCIvLypbQHRleHQ9J0FiYmF5ZSBkZSBCZWxsb2MnXVwiKVxuICAgICAgLnNob3VsZC5ldmVudHVhbGx5LmJlLnJlamVjdGVkV2l0aCgvTm9TdWNoRWxlbWVudC8pO1xuICB9XG5cbiAgbGV0IGlkQ291bnRlciA9IDA7XG5cbiAgY29uc3QgcGVyZm9ybVRvdWNoQWN0aW9uID0gYXN5bmMgZnVuY3Rpb24gKC4uLmFjdGlvbnNBcnJheXMpIHtcbiAgICBjb25zdCBhY3Rpb25zUm9vdCA9IFtdO1xuXG4gICAgZm9yIChsZXQgYWN0aW9ucyBvZiBhY3Rpb25zQXJyYXlzKSB7XG4gICAgICBhY3Rpb25zUm9vdC5wdXNoKHtcbiAgICAgICAgdHlwZTogJ3BvaW50ZXInLFxuICAgICAgICBpZDogYGlkXyR7aWRDb3VudGVyKyt9YCxcbiAgICAgICAgcGFyYW1ldGVyczoge1xuICAgICAgICAgIHBvaW50ZXJUeXBlOiAndG91Y2gnXG4gICAgICAgIH0sXG4gICAgICAgIGFjdGlvbnMsXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBhd2FpdCByZXF1ZXN0KHtcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgdXJpOiBgaHR0cDovLyR7SE9TVH06JHtQT1JUfS93ZC9odWIvc2Vzc2lvbi8ke3Nlc3Npb25JZH0vYWN0aW9uc2AsXG4gICAgICBib2R5OiB7YWN0aW9uczogYWN0aW9uc1Jvb3R9LFxuICAgICAganNvbjogdHJ1ZSxcbiAgICB9KTtcbiAgfTtcblxuICBkZXNjcmliZSgnZmluZ2VycGFpbnQnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgYmVmb3JlRWFjaChzdGFydEZpbmdlclBhaW50QWN0aXZpdHkpO1xuXG4gICAgaXQoJ3Nob3VsZCBkcmF3IHRoZSBsZXR0ZXIgTCBvbiBmaW5nZXJwYWludCcsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgIGNvbnN0IGNhbnZhcyA9IGF3YWl0IGRyaXZlci5lbGVtZW50QnlJZChcImFuZHJvaWQ6aWQvY29udGVudFwiKTtcbiAgICAgIGNvbnN0IHt4LCB5fSA9IGF3YWl0IGNhbnZhcy5nZXRMb2NhdGlvbigpO1xuICAgICAgY29uc3Qge2hlaWdodCwgd2lkdGh9ID0gYXdhaXQgY2FudmFzLmdldFNpemUoKTtcblxuICAgICAgY29uc3Qgc3RhcnRYID0geCArIDEwO1xuICAgICAgY29uc3Qgc3RhcnRZID0geSArIDEwO1xuICAgICAgY29uc3QgZW5kWCA9IHggKyB3aWR0aCAtIDEwO1xuICAgICAgY29uc3QgZW5kWSA9IHkgKyBNYXRoLnJvdW5kKGhlaWdodCAvIDIpO1xuXG4gICAgICBjb25zdCB0b3VjaEFjdGlvbnMgPSBbXG4gICAgICAgIHt0eXBlOiBcInBvaW50ZXJNb3ZlXCIsIGR1cmF0aW9uOiAxMDAwLCB4OiBzdGFydFgsIHk6IHN0YXJ0WX0sXG4gICAgICAgIHt0eXBlOiBcInBvaW50ZXJEb3duXCIsIGJ1dHRvbjogMH0sXG4gICAgICAgIHt0eXBlOiBcInBvaW50ZXJNb3ZlXCIsIGR1cmF0aW9uOiAxMDAwLCAgeDogc3RhcnRYLCB5OiBlbmRZfSxcbiAgICAgICAge3R5cGU6IFwicGF1c2VcIiwgZHVyYXRpb246IDEwMDB9LFxuICAgICAgICB7dHlwZTogXCJwb2ludGVyTW92ZVwiLCBkdXJhdGlvbjogMTAwMCwgIHg6IGVuZFgsIHk6IGVuZFl9LFxuICAgICAgICB7dHlwZTogXCJwb2ludGVyQ2FuY2VsXCIsIGJ1dHRvbjogMH0sXG4gICAgICBdO1xuICAgICAgYXdhaXQgcGVyZm9ybVRvdWNoQWN0aW9uKHRvdWNoQWN0aW9ucyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGRyYXcgdHdvIHBhcmFsbGVsIGxpbmVzIG9uIGZpbmdlcnBhaW50JywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgY29uc3QgY2FudmFzID0gYXdhaXQgZHJpdmVyLmVsZW1lbnRCeUlkKFwiYW5kcm9pZDppZC9jb250ZW50XCIpO1xuICAgICAgY29uc3Qge3gsIHl9ID0gYXdhaXQgY2FudmFzLmdldExvY2F0aW9uKCk7XG4gICAgICBjb25zdCB7aGVpZ2h0LCB3aWR0aH0gPSBhd2FpdCBjYW52YXMuZ2V0U2l6ZSgpO1xuXG4gICAgICBjb25zdCB0b3VjaEFjdGlvbnMgPSBbMTAsIHdpZHRoIC0gMTBdLnJlZHVjZShmdW5jdGlvbiAodG91Y2hBY3Rpb25zLCB4T2Zmc2V0KSB7XG4gICAgICAgIHRvdWNoQWN0aW9ucy5wdXNoKFtcbiAgICAgICAgICB7dHlwZTogXCJwb2ludGVyTW92ZVwiLCB4OiB4ICsgeE9mZnNldCwgeTogeSArIDEwfSxcbiAgICAgICAgICB7dHlwZTogXCJwb2ludGVyRG93blwiLCBidXR0b246IDB9LFxuICAgICAgICAgIHt0eXBlOiBcInBvaW50ZXJNb3ZlXCIsIGR1cmF0aW9uOiAyMDAwLCAgeDogeCArIHhPZmZzZXQsIHk6IHkgKyBNYXRoLnJvdW5kKGhlaWdodCAvIDIpfSxcbiAgICAgICAgICB7dHlwZTogXCJwb2ludGVyVXBcIiwgYnV0dG9uOiAwfSxcbiAgICAgICAgXSk7XG4gICAgICAgIHJldHVybiB0b3VjaEFjdGlvbnM7XG4gICAgICB9LCBbXSk7XG4gICAgICBhd2FpdCBwZXJmb3JtVG91Y2hBY3Rpb24oLi4udG91Y2hBY3Rpb25zKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3Njcm9sbGluZy9zd2lwaW5nJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgIGRlc2NyaWJlKCdzaW5nbGUnLCBmdW5jdGlvbiAoKSB7XG4gICAgICBiZWZvcmVFYWNoKHN0YXJ0TGlzdEFjdGl2aXR5KTtcblxuICAgICAgaXQoJ3Nob3VsZCBzY3JvbGwgdXAgbWVudScsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY29uc3Qge3N0YXJ0WCwgc3RhcnRZLCBlbmRYLCBlbmRZfSA9IGF3YWl0IGdldFNjcm9sbERhdGEoKTtcblxuICAgICAgICBjb25zdCBhY3Rpb25zID0gW1xuICAgICAgICAgIHt0eXBlOiBcInBvaW50ZXJNb3ZlXCIsIGR1cmF0aW9uOiAwLCB4OiBzdGFydFggKyA1LCB5OiBzdGFydFkgKyA1fSxcbiAgICAgICAgICB7dHlwZTogXCJwb2ludGVyRG93blwiLCBidXR0b246IDB9LFxuICAgICAgICAgIHt0eXBlOiBcInBvaW50ZXJNb3ZlXCIsIGR1cmF0aW9uOiAyMDAsICB4OiBlbmRYICsgNSwgeTogZW5kWSArIDV9LFxuICAgICAgICAgIHt0eXBlOiBcInBvaW50ZXJVcFwiLCBidXR0b246IDB9XG4gICAgICAgIF07XG4gICAgICAgIGF3YWl0IHBlcmZvcm1Ub3VjaEFjdGlvbihhY3Rpb25zKTtcblxuICAgICAgICBhd2FpdCBhc3NlcnRTY3JvbGwoKTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIHN3aXBlIHVwIG1lbnUnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNvbnN0IHtzdGFydFgsIHN0YXJ0WSwgZW5kWCwgZW5kWX0gPSBhd2FpdCBnZXRTY3JvbGxEYXRhKCk7XG5cbiAgICAgICAgY29uc3QgYWN0aW9ucyA9IFtcbiAgICAgICAgICB7dHlwZTogXCJwb2ludGVyTW92ZVwiLCBkdXJhdGlvbjogMCwgIHg6IHN0YXJ0WCArIDUsIHk6IHN0YXJ0WSArIDV9LFxuICAgICAgICAgIHt0eXBlOiBcInBvaW50ZXJEb3duXCIsIGJ1dHRvbjogMH0sXG4gICAgICAgICAge3R5cGU6IFwicG9pbnRlck1vdmVcIiwgZHVyYXRpb246IDEwMCwgIHg6IGVuZFggKyA1LCB5OiBlbmRZICsgNX0sXG4gICAgICAgICAge3R5cGU6IFwicG9pbnRlclVwXCIsIGJ1dHRvbjogMH1cbiAgICAgICAgXTtcbiAgICAgICAgYXdhaXQgcGVyZm9ybVRvdWNoQWN0aW9uKGFjdGlvbnMpO1xuXG4gICAgICAgIGF3YWl0IGFzc2VydFNjcm9sbCgpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnbXVsdGlwbGUnLCBmdW5jdGlvbiAoKSB7XG4gICAgICBiZWZvcmVFYWNoKHN0YXJ0U3BsaXRUb3VjaEFjdGl2aXR5KTtcbiAgICAgIGl0KCdzaG91bGQgZG8gbXVsdGlwbGUgc2Nyb2xscyBvbiBtdWx0aXBsZSB2aWV3cycsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY29uc3QgZWxzID0gYXdhaXQgZHJpdmVyLmVsZW1lbnRzQnlDbGFzc05hbWUoJ2FuZHJvaWQud2lkZ2V0Lkxpc3RWaWV3Jyk7XG5cbiAgICAgICAgY29uc3QgYWN0aW9ucyA9IGF3YWl0IEIubWFwKGVscywgYXN5bmMgZnVuY3Rpb24gKGVsKSB7XG4gICAgICAgICAgY29uc3Qge2hlaWdodH0gPSBhd2FpdCBlbC5nZXRTaXplKCk7XG5cbiAgICAgICAgICBjb25zdCB5TW92ZSA9IE1hdGgucm91bmQoaGVpZ2h0IC8gMikgLSAxMDtcblxuICAgICAgICAgIGNvbnN0IGFjdGlvbiA9IFtcbiAgICAgICAgICAgIHt0eXBlOiBcInBvaW50ZXJNb3ZlXCIsIG9yaWdpbjoge1wiZWxlbWVudC02MDY2LTExZTQtYTUyZS00ZjczNTQ2NmNlY2ZcIjogZWwudmFsdWV9fSxcbiAgICAgICAgICAgIHt0eXBlOiBcInBvaW50ZXJEb3duXCIsIGJ1dHRvbjogMH0sXG4gICAgICAgICAgICB7dHlwZTogXCJwb2ludGVyTW92ZVwiLCBvcmlnaW46IHtcImVsZW1lbnQtNjA2Ni0xMWU0LWE1MmUtNGY3MzU0NjZjZWNmXCI6IGVsLnZhbHVlfSwgeDogMTAsIHk6IC15TW92ZSwgZHVyYXRpb246IDMwMDB9LFxuICAgICAgICAgICAge3R5cGU6IFwicG9pbnRlck1vdmVcIiwgb3JpZ2luOiBcInBvaW50ZXJcIiwgeDogMTAsIHk6IC15TW92ZSwgZHVyYXRpb246IDMwMDB9LFxuICAgICAgICAgICAge3R5cGU6IFwicG9pbnRlclVwXCIsIGJ1dHRvbjogMH0sXG4gICAgICAgICAgXTtcbiAgICAgICAgICByZXR1cm4gYWN0aW9uO1xuICAgICAgICB9KTtcblxuICAgICAgICBhd2FpdCBwZXJmb3JtVG91Y2hBY3Rpb24oLi4uYWN0aW9ucyk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgc3dpcGUgb24gZHJhZyBhbmQgZHJvcCcsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgIGF3YWl0IHN0YXJ0RHJhZ0FuZERyb3BBY3Rpdml0eSgpO1xuXG4gICAgICBjb25zdCBlbCA9IGF3YWl0IGRyaXZlci5lbGVtZW50QnlJZChcImlvLmFwcGl1bS5hbmRyb2lkLmFwaXM6aWQvZHJhZ19kb3RfMVwiKTtcbiAgICAgIGNvbnN0IHt4LCB5fSA9IGF3YWl0IGVsLmdldExvY2F0aW9uKCk7XG5cbiAgICAgIGNvbnN0IHRvdWNoQWN0aW9ucyA9IFtcbiAgICAgICAge3R5cGU6IFwicG9pbnRlck1vdmVcIiwgZHVyYXRpb246IDAsIHg6IHggKyAzMCwgeTogeSArIDMwfSxcbiAgICAgICAge3R5cGU6IFwicG9pbnRlckRvd25cIiwgYnV0dG9uOiAwfSxcbiAgICAgICAge3R5cGU6IFwicG9pbnRlck1vdmVcIiwgZHVyYXRpb246IDEwMCwgIHg6IHggKyAxMCwgeTogeSArIDEwfSxcbiAgICAgICAge3R5cGU6IFwicG9pbnRlclVwXCIsIGJ1dHRvbjogMH0sXG4gICAgICBdO1xuICAgICAgYXdhaXQgcGVyZm9ybVRvdWNoQWN0aW9uKHRvdWNoQWN0aW9ucyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCd0b3VjaGVzJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgIGxldCBuZXh0RWw7XG5cbiAgICBiZWZvcmVFYWNoKGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgIGF3YWl0IHN0YXJ0VGV4dFN3aXRjaGVyQWN0aXZpdHkoKTtcblxuICAgICAgYXdhaXQgZHJpdmVyLmVsZW1lbnRCeVhQYXRoKFwiLy8qW0B0ZXh0PScwJ11cIikuc2hvdWxkLmV2ZW50dWFsbHkuZXhpc3Q7XG4gICAgICBhd2FpdCBkcml2ZXIuZWxlbWVudEJ5WFBhdGgoXCIvLypbQHRleHQ9JzEnXVwiKS5zaG91bGQuZXZlbnR1YWxseS5iZS5yZWplY3RlZFdpdGgoL05vU3VjaEVsZW1lbnQvKTtcblxuICAgICAgbmV4dEVsID0gYXdhaXQgZHJpdmVyLmVsZW1lbnRCeUFjY2Vzc2liaWxpdHlJZCgnTmV4dCcpO1xuICAgIH0pO1xuICAgIGl0KCdzaG91bGQgdG91Y2ggZG93biBhbmQgdXAnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBjb25zdCB7eCwgeX0gPSBhd2FpdCBuZXh0RWwuZ2V0TG9jYXRpb24oKTtcblxuICAgICAgY29uc3QgdG91Y2hBY3Rpb25zID0gW1xuICAgICAgICB7dHlwZTogXCJwb2ludGVyTW92ZVwiLCBkdXJhdGlvbjogMTAwLCB4OiB4ICsgMTAsIHk6IHkgKyAxMH0sXG4gICAgICAgIHt0eXBlOiBcInBvaW50ZXJEb3duXCIsIGJ1dHRvbjogMH0sXG4gICAgICAgIHt0eXBlOiBcInBhdXNlXCIsIGR1cmF0aW9uOiAzMDAwfSxcbiAgICAgICAge3R5cGU6IFwicG9pbnRlclVwXCIsIGJ1dHRvbjogMH0sXG4gICAgICBdO1xuICAgICAgYXdhaXQgcGVyZm9ybVRvdWNoQWN0aW9uKHRvdWNoQWN0aW9ucyk7XG5cbiAgICAgIGF3YWl0IGRyaXZlci5lbGVtZW50QnlYUGF0aChcIi8vKltAdGV4dD0nMSddXCIpLnNob3VsZC5ldmVudHVhbGx5LmV4aXN0O1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB0b3VjaCBkb3duIGFuZCB1cCBvbiBhbiBlbGVtZW50IGJ5IGlkJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgY29uc3QgdG91Y2hBY3Rpb25zID0gW1xuICAgICAgICB7dHlwZTogXCJwb2ludGVyTW92ZVwiLCBkdXJhdGlvbjogMCwgb3JpZ2luOiB7XCJlbGVtZW50LTYwNjYtMTFlNC1hNTJlLTRmNzM1NDY2Y2VjZlwiOiBuZXh0RWwudmFsdWV9fSxcbiAgICAgICAge3R5cGU6IFwicG9pbnRlckRvd25cIiwgYnV0dG9uOiAwfSxcbiAgICAgICAge3R5cGU6IFwicGF1c2VcIiwgZHVyYXRpb246IDEwMH0sXG4gICAgICAgIHt0eXBlOiBcInBvaW50ZXJVcFwiLCBidXR0b246IDB9LFxuICAgICAgXTtcbiAgICAgIGF3YWl0IHBlcmZvcm1Ub3VjaEFjdGlvbih0b3VjaEFjdGlvbnMpO1xuXG4gICAgICBhd2FpdCBkcml2ZXIuZWxlbWVudEJ5WFBhdGgoXCIvLypbQHRleHQ9JzEnXVwiKS5zaG91bGQuZXZlbnR1YWxseS5leGlzdDtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ21qc29ud3AgdG91Y2ggYWN0aW9ucycsIGZ1bmN0aW9uICgpIHtcbiAgICBkZXNjcmliZSgndG91Y2gnLCBmdW5jdGlvbiAoKSB7XG4gICAgICBsZXQgbmV4dEVsO1xuXG4gICAgICBiZWZvcmVFYWNoKGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgYXdhaXQgc3RhcnRUZXh0U3dpdGNoZXJBY3Rpdml0eSgpO1xuXG4gICAgICAgIGF3YWl0IGRyaXZlci5lbGVtZW50QnlYUGF0aChcIi8vKltAdGV4dD0nMCddXCIpLnNob3VsZC5ldmVudHVhbGx5LmV4aXN0O1xuICAgICAgICBhd2FpdCBkcml2ZXIuZWxlbWVudEJ5WFBhdGgoXCIvLypbQHRleHQ9JzEnXVwiKS5zaG91bGQuZXZlbnR1YWxseS5iZS5yZWplY3RlZFdpdGgoL05vU3VjaEVsZW1lbnQvKTtcblxuICAgICAgICBuZXh0RWwgPSBhd2FpdCBkcml2ZXIuZWxlbWVudEJ5QWNjZXNzaWJpbGl0eUlkKCdOZXh0Jyk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCBkbyB0b3VjaC9jbGljayBldmVudCcsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY29uc3Qge3ZhbHVlOmVsZW1lbnRJZH0gPSBuZXh0RWw7XG4gICAgICAgIGF3YWl0IHJlcXVlc3Qoe1xuICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgIHVyaTogYGh0dHA6Ly8ke0hPU1R9OiR7UE9SVH0vd2QvaHViL3Nlc3Npb24vJHtzZXNzaW9uSWR9L3RvdWNoL2NsaWNrYCxcbiAgICAgICAgICBib2R5OiB7XG4gICAgICAgICAgICBlbGVtZW50OiBlbGVtZW50SWQsXG4gICAgICAgICAgfSxcbiAgICAgICAgICBqc29uOiB0cnVlLFxuICAgICAgICB9KTtcblxuICAgICAgICBhd2FpdCBkcml2ZXIuZWxlbWVudEJ5WFBhdGgoXCIvLypbQHRleHQ9JzEnXVwiKS5zaG91bGQuZXZlbnR1YWxseS5leGlzdDtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIGRvIHRvdWNoL2xvbmdjbGljayBldmVudCcsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY29uc3Qge3ZhbHVlOmVsZW1lbnRJZH0gPSBuZXh0RWw7XG4gICAgICAgIGF3YWl0IHJlcXVlc3Qoe1xuICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgIHVyaTogYGh0dHA6Ly8ke0hPU1R9OiR7UE9SVH0vd2QvaHViL3Nlc3Npb24vJHtzZXNzaW9uSWR9L3RvdWNoL2xvbmdjbGlja2AsXG4gICAgICAgICAgYm9keToge1xuICAgICAgICAgICAgZWxlbWVudDogZWxlbWVudElkLFxuICAgICAgICAgIH0sXG4gICAgICAgICAganNvbjogdHJ1ZSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgYXdhaXQgZHJpdmVyLmVsZW1lbnRCeVhQYXRoKFwiLy8qW0B0ZXh0PScxJ11cIikuc2hvdWxkLmV2ZW50dWFsbHkuZXhpc3Q7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCBkbyB0b3VjaC9kb3VibGVjbGljayBldmVudCcsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgYXdhaXQgZHJpdmVyLmVsZW1lbnRCeVhQYXRoKFwiLy8qW0B0ZXh0PScyJ11cIikuc2hvdWxkLmV2ZW50dWFsbHkuYmUucmVqZWN0ZWRXaXRoKC9Ob1N1Y2hFbGVtZW50Lyk7XG5cbiAgICAgICAgY29uc3Qge3ZhbHVlOmVsZW1lbnRJZH0gPSBuZXh0RWw7XG4gICAgICAgIGF3YWl0IHJlcXVlc3Qoe1xuICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgIHVyaTogYGh0dHA6Ly8ke0hPU1R9OiR7UE9SVH0vd2QvaHViL3Nlc3Npb24vJHtzZXNzaW9uSWR9L3RvdWNoL2RvdWJsZWNsaWNrYCxcbiAgICAgICAgICBib2R5OiB7XG4gICAgICAgICAgICBlbGVtZW50OiBlbGVtZW50SWQsXG4gICAgICAgICAgfSxcbiAgICAgICAgICBqc29uOiB0cnVlLFxuICAgICAgICB9KTtcblxuICAgICAgICBhd2FpdCBkcml2ZXIuZWxlbWVudEJ5WFBhdGgoXCIvLypbQHRleHQ9JzEnXVwiKS5zaG91bGQuZXZlbnR1YWxseS5leGlzdDtcbiAgICAgICAgYXdhaXQgZHJpdmVyLmVsZW1lbnRCeVhQYXRoKFwiLy8qW0B0ZXh0PScyJ11cIikuc2hvdWxkLmV2ZW50dWFsbHkuZXhpc3Q7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCB0b3VjaCBkb3duIGF0IGEgbG9jYXRpb24gYW5kIHRoZW4gdG91Y2ggdXAnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNvbnN0IHt4LCB5fSA9IGF3YWl0IG5leHRFbC5nZXRMb2NhdGlvbigpO1xuXG4gICAgICAgIGF3YWl0IHJlcXVlc3Qoe1xuICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgIHVyaTogYGh0dHA6Ly8ke0hPU1R9OiR7UE9SVH0vd2QvaHViL3Nlc3Npb24vJHtzZXNzaW9uSWR9L3RvdWNoL2Rvd25gLFxuICAgICAgICAgIGJvZHk6IHtcbiAgICAgICAgICAgIHg6IHggKyAxLFxuICAgICAgICAgICAgeTogeSArIDEsXG4gICAgICAgICAgfSxcbiAgICAgICAgICBqc29uOiB0cnVlLFxuICAgICAgICB9KTtcbiAgICAgICAgYXdhaXQgQi5kZWxheSgxMDAwKTtcblxuICAgICAgICBhd2FpdCByZXF1ZXN0KHtcbiAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICB1cmk6IGBodHRwOi8vJHtIT1NUfToke1BPUlR9L3dkL2h1Yi9zZXNzaW9uLyR7c2Vzc2lvbklkfS90b3VjaC91cGAsXG4gICAgICAgICAgYm9keToge1xuICAgICAgICAgICAgeDogeCArIDEsXG4gICAgICAgICAgICB5OiB5ICsgMSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIGpzb246IHRydWUsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGF3YWl0IGRyaXZlci5lbGVtZW50QnlYUGF0aChcIi8vKltAdGV4dD0nMSddXCIpLnNob3VsZC5ldmVudHVhbGx5LmV4aXN0O1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnbW92ZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGJlZm9yZUVhY2goc3RhcnRMaXN0QWN0aXZpdHkpO1xuXG4gICAgICBpdCgnc2hvdWxkIHRvdWNoIGRvd24sIG1vdmUsIHRvdWNoIHVwIGFuZCBjYXVzZSBhIHNjcm9sbCBldmVudCcsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY29uc3Qge3N0YXJ0WCwgc3RhcnRZLCBlbmRYLCBlbmRZfSA9IGF3YWl0IGdldFNjcm9sbERhdGEoKTtcblxuICAgICAgICBhd2FpdCByZXF1ZXN0KHtcbiAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICB1cmk6IGBodHRwOi8vJHtIT1NUfToke1BPUlR9L3dkL2h1Yi9zZXNzaW9uLyR7c2Vzc2lvbklkfS90b3VjaC9kb3duYCxcbiAgICAgICAgICBib2R5OiB7XG4gICAgICAgICAgICB4OiBzdGFydFggKyAxLFxuICAgICAgICAgICAgeTogc3RhcnRZICsgMSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIGpzb246IHRydWUsXG4gICAgICAgIH0pO1xuICAgICAgICBhd2FpdCBCLmRlbGF5KDEwMDApO1xuXG4gICAgICAgIGF3YWl0IHJlcXVlc3Qoe1xuICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgIHVyaTogYGh0dHA6Ly8ke0hPU1R9OiR7UE9SVH0vd2QvaHViL3Nlc3Npb24vJHtzZXNzaW9uSWR9L3RvdWNoL21vdmVgLFxuICAgICAgICAgIGJvZHk6IHtcbiAgICAgICAgICAgIHg6IGVuZFggKyAxLFxuICAgICAgICAgICAgeTogZW5kWSArIDEsXG4gICAgICAgICAgfSxcbiAgICAgICAgICBqc29uOiB0cnVlLFxuICAgICAgICB9KTtcbiAgICAgICAgYXdhaXQgQi5kZWxheSgxMDAwKTtcblxuICAgICAgICBhd2FpdCByZXF1ZXN0KHtcbiAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICB1cmk6IGBodHRwOi8vJHtIT1NUfToke1BPUlR9L3dkL2h1Yi9zZXNzaW9uLyR7c2Vzc2lvbklkfS90b3VjaC91cGAsXG4gICAgICAgICAgYm9keToge1xuICAgICAgICAgICAgeDogZW5kWCArIDEsXG4gICAgICAgICAgICB5OiBlbmRZICsgMSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIGpzb246IHRydWUsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGF3YWl0IGFzc2VydFNjcm9sbCgpO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgc2Nyb2xsIG9uIGFuIGVsZW1lbnQnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGF3YWl0IHJlcXVlc3Qoe1xuICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgIHVyaTogYGh0dHA6Ly8ke0hPU1R9OiR7UE9SVH0vd2QvaHViL3Nlc3Npb24vJHtzZXNzaW9uSWR9L3RvdWNoL3Njcm9sbGAsXG4gICAgICAgICAgYm9keToge1xuICAgICAgICAgICAgLy9lbGVtZW50OiBlbC52YWx1ZSxcbiAgICAgICAgICAgIHg6IDAsXG4gICAgICAgICAgICB5OiAtMzAwLFxuICAgICAgICAgIH0sXG4gICAgICAgICAganNvbjogdHJ1ZSxcbiAgICAgICAgfSk7XG4gICAgICAgIGF3YWl0IEIuZGVsYXkoMTAwMCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ21qc29ud3AgdG91Y2ggYWN0aW9ucycsIGZ1bmN0aW9uICgpIHtcbiAgICBkZXNjcmliZSgnbXVsdGkgdG91Y2ggYWN0aW9ucycsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCBuZXh0RWw7XG5cbiAgICAgIGJlZm9yZUVhY2goYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgICBhd2FpdCBzdGFydFRleHRTd2l0Y2hlckFjdGl2aXR5KCk7XG5cbiAgICAgICAgYXdhaXQgZHJpdmVyLmVsZW1lbnRCeVhQYXRoKFwiLy8qW0B0ZXh0PScwJ11cIikuc2hvdWxkLmV2ZW50dWFsbHkuZXhpc3Q7XG4gICAgICAgIGF3YWl0IGRyaXZlci5lbGVtZW50QnlYUGF0aChcIi8vKltAdGV4dD0nMSddXCIpLnNob3VsZC5ldmVudHVhbGx5LmJlLnJlamVjdGVkV2l0aCgvTm9TdWNoRWxlbWVudC8pO1xuXG4gICAgICAgIG5leHRFbCA9IGF3YWl0IGRyaXZlci5lbGVtZW50QnlBY2Nlc3NpYmlsaXR5SWQoJ05leHQnKTtcbiAgICAgIH0pO1xuXG4gICAgICBmb3IgKGNvbnN0IG1ldGhvZCBvZiBbJ3RhcCcsICdwcmVzcycsICdsb25nUHJlc3MnXSkge1xuICAgICAgICBpdChgc2hvdWxkIHBlcmZvcm0gc2luZ2xlICR7bWV0aG9kfSBhY3Rpb25zIG9uIGFuIGVsZW1lbnRgLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgY29uc3QgYWN0aW9uID0gbmV3IHdkLlRvdWNoQWN0aW9uKCk7XG4gICAgICAgICAgYWN0aW9uW21ldGhvZF0oe2VsOiBuZXh0RWx9KTtcblxuICAgICAgICAgIGNvbnN0IG11bHRpQWN0aW9uID0gbmV3IHdkLk11bHRpQWN0aW9uKGRyaXZlcik7XG4gICAgICAgICAgbXVsdGlBY3Rpb24uYWRkKGFjdGlvbik7XG4gICAgICAgICAgYXdhaXQgbXVsdGlBY3Rpb24ucGVyZm9ybSgpO1xuXG4gICAgICAgICAgYXdhaXQgZHJpdmVyLmVsZW1lbnRCeVhQYXRoKFwiLy8qW0B0ZXh0PScxJ11cIikuc2hvdWxkLmV2ZW50dWFsbHkuZXhpc3Q7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KGBzaG91bGQgcGVyZm9ybSBzaW5nbGUgJHttZXRob2R9IGFjdGlvbnNgLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgY29uc3Qge3gsIHl9ID0gYXdhaXQgbmV4dEVsLmdldExvY2F0aW9uKCk7XG5cbiAgICAgICAgICBjb25zdCBhY3Rpb24gPSBuZXcgd2QuVG91Y2hBY3Rpb24oKTtcbiAgICAgICAgICBhY3Rpb25bbWV0aG9kXSh7eDogeCArIDEwLCB5OiB5ICsgMTB9KTtcblxuICAgICAgICAgIGNvbnN0IG11bHRpQWN0aW9uID0gbmV3IHdkLk11bHRpQWN0aW9uKGRyaXZlcik7XG4gICAgICAgICAgbXVsdGlBY3Rpb24uYWRkKGFjdGlvbik7XG4gICAgICAgICAgYXdhaXQgbXVsdGlBY3Rpb24ucGVyZm9ybSgpO1xuXG4gICAgICAgICAgYXdhaXQgZHJpdmVyLmVsZW1lbnRCeVhQYXRoKFwiLy8qW0B0ZXh0PScxJ11cIikuc2hvdWxkLmV2ZW50dWFsbHkuZXhpc3Q7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ3RvdWNoIGFjdGlvbnMnLCBmdW5jdGlvbiAoKSB7XG4gICAgICBkZXNjcmliZSgndGFwL3ByZXNzL2xvbmdQcmVzcycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgbGV0IG5leHRFbDtcblxuICAgICAgICBiZWZvcmVFYWNoKGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBhd2FpdCBzdGFydFRleHRTd2l0Y2hlckFjdGl2aXR5KCk7XG5cbiAgICAgICAgICBhd2FpdCBkcml2ZXIuZWxlbWVudEJ5WFBhdGgoXCIvLypbQHRleHQ9JzAnXVwiKS5zaG91bGQuZXZlbnR1YWxseS5leGlzdDtcbiAgICAgICAgICBhd2FpdCBkcml2ZXIuZWxlbWVudEJ5WFBhdGgoXCIvLypbQHRleHQ9JzEnXVwiKS5zaG91bGQuZXZlbnR1YWxseS5iZS5yZWplY3RlZFdpdGgoL05vU3VjaEVsZW1lbnQvKTtcblxuICAgICAgICAgIG5leHRFbCA9IGF3YWl0IGRyaXZlci5lbGVtZW50QnlBY2Nlc3NpYmlsaXR5SWQoJ05leHQnKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgZm9yIChjb25zdCBtZXRob2Qgb2YgWyd0YXAnLCAncHJlc3MnLCAnbG9uZ1ByZXNzJ10pIHtcbiAgICAgICAgICBpdChgc2hvdWxkIHBlcmZvcm0gc2luZ2xlICR7bWV0aG9kfSBhY3Rpb25zYCwgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgY29uc3Qge3gsIHl9ID0gYXdhaXQgbmV4dEVsLmdldExvY2F0aW9uKCk7XG5cbiAgICAgICAgICAgIGNvbnN0IGFjdGlvbiA9IG5ldyB3ZC5Ub3VjaEFjdGlvbihkcml2ZXIpO1xuICAgICAgICAgICAgYWN0aW9uW21ldGhvZF0oe3g6IHggKyAxMCwgeTogeSArIDEwfSk7XG4gICAgICAgICAgICBhd2FpdCBhY3Rpb24ucGVyZm9ybSgpO1xuXG4gICAgICAgICAgICBhd2FpdCBkcml2ZXIuZWxlbWVudEJ5WFBhdGgoXCIvLypbQHRleHQ9JzEnXVwiKS5zaG91bGQuZXZlbnR1YWxseS5leGlzdDtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBpdChgc2hvdWxkIHBlcmZvcm0gc2luZ2xlICR7bWV0aG9kfSBhY3Rpb25zIG9uIGFuIGVsZW1lbnRgLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBsZXQgYWN0aW9uID0gbmV3IHdkLlRvdWNoQWN0aW9uKGRyaXZlcik7XG4gICAgICAgICAgICBhY3Rpb25bbWV0aG9kXSh7ZWw6IG5leHRFbH0pO1xuICAgICAgICAgICAgYXdhaXQgYWN0aW9uLnBlcmZvcm0oKTtcblxuICAgICAgICAgICAgYXdhaXQgZHJpdmVyLmVsZW1lbnRCeVhQYXRoKFwiLy8qW0B0ZXh0PScxJ11cIikuc2hvdWxkLmV2ZW50dWFsbHkuZXhpc3Q7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgaXQoJ3Nob3VsZCBwZXJmb3JtIGEgc2Nyb2xsIGV2ZW50JywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgICBhd2FpdCBzdGFydExpc3RBY3Rpdml0eSgpO1xuXG4gICAgICAgIGNvbnN0IHtzdGFydEVsLCBlbmRFbH0gPSBhd2FpdCBnZXRTY3JvbGxEYXRhKCk7XG5cbiAgICAgICAgY29uc3QgYWN0aW9uID0gbmV3IHdkLlRvdWNoQWN0aW9uKGRyaXZlcik7XG4gICAgICAgIGFjdGlvbi5wcmVzcyh7ZWw6IHN0YXJ0RWx9KTtcbiAgICAgICAgYWN0aW9uLm1vdmVUbyh7ZWw6IGVuZEVsfSk7XG4gICAgICAgIGFjdGlvbi5yZWxlYXNlKCk7XG4gICAgICAgIGF3YWl0IGFjdGlvbi5wZXJmb3JtKCk7XG5cbiAgICAgICAgYXdhaXQgYXNzZXJ0U2Nyb2xsKCk7XG4gICAgICB9KTtcbiAgICAgIGl0KCdzaG91bGQgZG8gbXVsdGlwbGUgc2Nyb2xscyBvbiBtdWx0aXBsZSB2aWV3cycsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgYXdhaXQgc3RhcnRTcGxpdFRvdWNoQWN0aXZpdHkoKTtcblxuICAgICAgICBjb25zdCBlbHMgPSBhd2FpdCBkcml2ZXIuZWxlbWVudHNCeUNsYXNzTmFtZSgnYW5kcm9pZC53aWRnZXQuTGlzdFZpZXcnKTtcbiAgICAgICAgY29uc3QgYWN0aW9ucyA9IGF3YWl0IEIubWFwKGVscywgYXN5bmMgZnVuY3Rpb24gKGVsKSB7XG4gICAgICAgICAgY29uc3Qge2hlaWdodH0gPSBhd2FpdCBlbC5nZXRTaXplKCk7XG4gICAgICAgICAgY29uc3QgaW5jcmVtZW50ID0gTWF0aC5yb3VuZCgoaGVpZ2h0IC0gMTApIC8gOCk7XG5cbiAgICAgICAgICBsZXQgYWN0aW9uID0gbmV3IHdkLlRvdWNoQWN0aW9uKClcbiAgICAgICAgICAgIC5wcmVzcyh7ZWxlbWVudDogZWx9KTtcbiAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDg7IGkrKykge1xuICAgICAgICAgICAgYWN0aW9uLm1vdmVUbyh7ZWxlbWVudDogZWwsIHg6IDEwLCB5OiAtaSAqIGluY3JlbWVudH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBhY3Rpb24ucmVsZWFzZSgpO1xuICAgICAgICAgIHJldHVybiBhY3Rpb247XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IG11bHRpQWN0aW9uID0gbmV3IHdkLk11bHRpQWN0aW9uKCk7XG4gICAgICAgIG11bHRpQWN0aW9uLmFkZCguLi5hY3Rpb25zKTtcblxuICAgICAgICBhd2FpdCBkcml2ZXIucGVyZm9ybU11bHRpQWN0aW9uKG11bHRpQWN0aW9uKTtcbiAgICAgICAgYXdhaXQgQi5kZWxheSg1MDAwKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuIl0sInNvdXJjZVJvb3QiOiIuLi8uLi8uLi8uLiJ9
